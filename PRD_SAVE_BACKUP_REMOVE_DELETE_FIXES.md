# PRD: 저장/백업/제거/삭제 버튼 기능 수정

## 문제 분석

### 발견된 주요 이슈

1. **중복된 함수 정의**
   - app.js에서 동일한 기능의 함수들이 여러 번 정의됨 (예: `saveCurrentFile`, `createBackup`, `downloadCurrentFile`, `removeCurrentFile`)
   - Lines 765-905와 1107-1231에서 동일한 함수들이 중복 정의됨

2. **inconsistent 함수 호출**
   - HTML에서 onclick으로 호출하는 전역 함수들이 EnvManager 클래스 메서드와 혼재됨
   - 일부 버튼은 클래스 메서드를, 일부는 전역 함수를 호출함

3. **에러 처리 부족**
   - 파일이 선택되지 않은 상태에서 버튼 클릭 시 적절한 피드백 부족
   - 네트워크 오류나 서버 오류에 대한 세밀한 처리 부족

4. **UX 문제**
   - 버튼 상태 변경이 일관되지 않음
   - 로딩 상태 표시가 모든 버튼에 적용되지 않음

## 해결 방안

### 1. 코드 구조 개선

#### 1.1 중복 함수 제거
- app.js에서 765-905 라인의 중복 함수 정의 제거
- 1107-1231 라인의 함수만 유지하되 기능 보완

#### 1.2 일관된 함수 구조 적용
```javascript
async function [functionName]() {
    // 1. 사전 조건 검사
    // 2. UI 상태 변경 (로딩 시작)
    // 3. 비즈니스 로직 실행
    // 4. 결과 처리
    // 5. UI 상태 복원
}
```

### 2. 기능별 수정 사항

#### 2.1 저장 기능 (`saveCurrentFile`)
**현재 문제:**
- 자동 백업 생성 로직이 서버 측에 있어 클라이언트에서 제어 불가
- 저장 실패 시 복구 옵션 없음

**수정 방안:**
- 저장 전 확인 다이얼로그 추가
- 저장 실패 시 재시도 옵션 제공
- 저장 성공 시 마지막 저장 시간 표시

#### 2.2 백업 기능 (`createBackup`)
**현재 문제:**
- 백업 파일명이 타임스탬프만으로 구성되어 식별 어려움
- 백업 성공 후 백업 파일 위치 확인 불가

**수정 방안:**
- 백업 파일명에 설명 추가 가능하도록 개선
- 백업 완료 후 백업 파일 다운로드 옵션 제공
- 백업 히스토리 관리 기능 추가

#### 2.3 제거 기능 (`removeCurrentFile`)
**현재 문제:**
- 실제 파일 삭제가 아닌 관리 목록에서만 제거됨이 불분명
- 제거 후 UI 상태 전환이 즉각적이지 않음

**수정 방안:**
- 제거 확인 다이얼로그에 명확한 설명 추가
- 제거 완료 후 파일 목록 자동 새로고침
- 실제 파일 삭제 옵션 추가 (위험한 작업이므로 별도 확인)

### 3. 공통 개선 사항

#### 3.1 에러 처리 강화
```javascript
try {
    // 메인 로직
} catch (error) {
    if (error.name === 'NetworkError') {
        // 네트워크 오류 처리
    } else if (error.status === 404) {
        // 파일 없음 오류 처리  
    } else {
        // 기타 오류 처리
    }
} finally {
    // UI 상태 복원
}
```

#### 3.2 UX 개선
- 모든 버튼에 로딩 상태 적용
- 작업 진행률 표시 (백업, 저장 등)
- 성공/실패 피드백 개선
- 키보드 단축키 지원 (Ctrl+S로 저장 등)

#### 3.3 상태 관리 개선
- 현재 파일 선택 상태 시각적 강화
- 변경 사항 있음/없음 표시
- 저장되지 않은 변경사항 경고

## 구현 계획

### Phase 1: 코드 정리 (1일)
1. 중복 함수 제거
2. 함수 구조 통일
3. 기본 에러 처리 추가

### Phase 2: 기능 개선 (2일)
1. 저장 기능 강화
2. 백업 기능 개선
3. 제거 기능 명확화

### Phase 3: UX 개선 (1일)
1. 로딩 상태 통일
2. 피드백 메시지 개선
3. 키보드 단축키 추가

## 성공 지표

1. **기능성**: 모든 버튼이 의도한 대로 작동
2. **안정성**: 오류 발생률 < 1%
3. **사용성**: 사용자 작업 완료 시간 20% 단축
4. **일관성**: 모든 버튼의 동작 패턴 통일

## 위험 요소 및 대응

1. **데이터 손실 위험**
   - 대응: 모든 변경 작업 전 자동 백업
   - 대응: 실행 취소 기능 제공

2. **파일 권한 문제**
   - 대응: 파일 권한 사전 검사
   - 대응: 명확한 오류 메시지 제공

3. **브라우저 호환성**
   - 대응: 주요 브라우저 테스트
   - 대응: 폴리필 적용

## 결론

이 PRD를 통해 저장/백업/제거/삭제 버튼의 모든 기능을 안정적이고 직관적으로 개선하여 사용자 경험을 크게 향상시킬 수 있습니다.